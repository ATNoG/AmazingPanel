<% if defined?(legend) and legend == true%>
<div class="testbed-legend">
  <p> Legend: </p>
  <div class="node-state"><div class="node off"></div><span>Off</span></div>
  <div class="node-state"><div class="node run"></div><span>On</span></div>
  <div class="node-state"><div class="node on"></div><span>Booting</span></div>
</div>
<% end %>

<%= content_tag :center do %>
  <%= content_tag :div, :id => "testbed-"+@testbed.id.to_s, :class => "testbed", 
    :style => "background-image: url('/images/testbeds/testbed-#{@testbed.id.to_s}.png');", :timestamp => Time.now.strftime("%s").to_s do %>
    <% length = 0 %>
    <% @nodes.each do |n| %>      
    <% if  ((length % 5) == 0) and (length != 0) %>
     <%= content_tag :div, "", :class => "clear" %>      	
    <% end %>      
    <%= content_tag(:div, n["id"], :id => "node-#{n["id"].to_i}",
                    :class => "node", :style => "position:relative; left: #{n['x'].to_i}px; top: #{n["y"].to_i}px") unless n["id"] == -1 %>
    <% length += 1 %>
    <% end %>
  <% end %>
<% end %> 
